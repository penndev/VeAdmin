import{e as E,h as R,i as T,j as q}from"./archive-29967a0d.js";import{r as _,f as u,o as F,c as M,g as t,w as o,j as s,t as N,a as g,F as $,E as m,x as j}from"./index-2134de4c.js";import"./request-3e2f35a1.js";const S=g("br",null,null,-1),z={class:"dialog-footer"},H={__name:"category",setup(I){const c=_({query:{limit:9999,page:1,order:null,name:null},data:[]}),f=()=>{E(c.value.query).then(i=>{const l=[],r={};for(const n of i.data)n.parent<1?l.push(n):r[n.parent]?r[n.parent].push(n):r[n.parent]=[n];for(const n of l.keys()){const p=l[n].id;r[p]&&(l[n].children=r[p])}c.value.data=l})},b=_(null),e=_({visible:!1,title:"dialog",form:{},formRule:{name:[{required:!0,message:"名称",trigger:"blur"},{min:2,message:"用户名最少为2个字符",trigger:"blur"}]},formAction:"add"}),y=()=>{e.value.title="新增模板组",e.value.visible=!0,e.value.formAction="add",e.value.form={}},V=i=>{e.value.title="修改模板组",e.value.visible=!0,e.value.formAction="edit",e.value.form=i},w=()=>{b.value.validate(i=>{i?e.value.formAction==="add"?R(e.value.form).then(l=>{e.value.visible=!1,m.success(l),f()}):e.value.formAction==="edit"?(T(e.value.form).then(l=>{e.value.visible=!1,m.info(l),f()}),e.value.visible=!1):m.warning("提交错误"):m.error("请输入正确的数据！")})},k=i=>{j.confirm("请仔细确认是否删除 "+i.name+" ?","警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{q({id:i.id}).then(l=>{m.warning(l),f()})})};return f(),(i,l)=>{const r=u("el-button"),n=u("el-table-column"),p=u("el-link"),h=u("el-table"),x=u("el-main"),v=u("el-input"),d=u("el-form-item"),C=u("el-switch"),A=u("el-input-number"),D=u("el-form"),B=u("el-dialog");return F(),M($,null,[t(x,{class:"ea-table"},{default:o(()=>[t(r,{type:"primary",icon:"Plus",onClick:y},{default:o(()=>[s(" 新增 ")]),_:1}),t(h,{data:c.value.data,style:{width:"100%"},"row-key":"id","default-expand-all":""},{default:o(()=>[t(n,{prop:"name",label:"名称",width:"140"}),t(n,{prop:"status",label:"状态",width:"180"},{default:o(a=>[t(p,{type:a.row.status>0?"success":"danger"},{default:o(()=>[s(N(a.row.status>0?a.row.status>1?a.row.status:"开启":"关闭"),1)]),_:2},1032,["type"])]),_:1}),t(n,{prop:"order",label:"排序",width:"180",sortable:""}),t(n,{prop:"updatedAt",label:"最近更新",width:"200"}),t(n,{prop:"createdAt",label:"创建日期",width:"200"}),t(n,{fixed:"right",label:"操作",width:"120"},{default:o(a=>[t(r,{link:"",type:"primary",onClick:U=>V(a.row)},{default:o(()=>[s(" 编辑 ")]),_:2},1032,["onClick"]),t(r,{link:"",type:"danger",onClick:U=>k(a.row)},{default:o(()=>[s(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),S]),_:1}),t(B,{modelValue:e.value.visible,"onUpdate:modelValue":l[6]||(l[6]=a=>e.value.visible=a),title:e.value.title,"close-on-click-modal":!1,"destroy-on-close":"","close-on-press-escape":"",center:""},{footer:o(()=>[g("span",z,[t(r,{onClick:l[5]||(l[5]=a=>e.value.visible=!1)},{default:o(()=>[s("取消")]),_:1}),t(r,{type:"primary",onClick:w},{default:o(()=>[s("确定")]),_:1})])]),default:o(()=>[t(D,{ref_key:"dialogRef",ref:b,"label-position":"left",model:e.value.form,rules:e.value.formRule},{default:o(()=>[t(d,{label:"名称",prop:"name"},{default:o(()=>[t(v,{modelValue:e.value.form.name,"onUpdate:modelValue":l[0]||(l[0]=a=>e.value.form.name=a)},null,8,["modelValue"])]),_:1}),t(d,{label:"状态"},{default:o(()=>[t(C,{modelValue:e.value.form.status,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.form.status=a),size:"large","active-text":"开启","inactive-text":"关闭","active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),t(d,{label:"父级",prop:"parent"},{default:o(()=>[t(A,{modelValue:e.value.form.parent,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.form.parent=a)},null,8,["modelValue"])]),_:1}),t(d,{label:"排序",prop:"order"},{default:o(()=>[t(v,{modelValue:e.value.form.order,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.form.order=a)},null,8,["modelValue"])]),_:1}),t(d,{label:"内容",prop:"content"},{default:o(()=>[t(v,{modelValue:e.value.form.content,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.form.content=a),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}};export{H as default};
