import{s as C,L as q,e as T,N as V,f as s,o as _,h as y,r as h,c as E,a as b,g as a,w as o,j as m,x as k,t as R,F as A,E as g,z as B}from"./index-0pK8Nv-_.js";const N=u=>C({url:"/example/list",method:"get",params:u}),$=u=>C({url:"/example/create",method:"post",data:u}),F=u=>C({url:"/example/update",method:"put",data:u}),L=u=>C({url:"/example/delete",method:"delete",params:u}),M={__name:"pagination",props:{pageSize:{type:Number,required:!0},pageSizeModifiers:{}},emits:["update:pageSize"],setup(u){const r=q(),e=T(),f=V(u,"pageSize");r.data[e.path]&&f.value!==r.data[e.path]&&r.data[e.path]>0&&(f.value=r.data[e.path]);const l=t=>{r.data[e.path]=t};return(t,n)=>{const c=s("el-pagination");return _(),y(c,{background:"",layout:"total, sizes, prev, pager, next","page-size":f.value,onSizeChange:l},null,8,["page-size"])}}},U={target:"_blank"},I=b("br",null,null,-1),P={class:"dialog-footer"},j={__name:"index",setup(u){const r=h(),e=h({selectStat:!1,total:0,query:{limit:20,page:1,order:null,name:null},data:[],handleTableData:()=>{N(e.value.query).then(t=>{e.value.data=t.data,e.value.total=t.total})},handleQueryRefresh:t=>{e.value.query.name=null,e.value.query.order=null,e.value.handleTableData()},handleChangePage:t=>{e.value.query.page=t,e.value.handleTableData()},handleChangeLimit:t=>{e.value.query.limit=t,e.value.handleTableData()},handleSortChange:({column:t,prop:n,order:c})=>{let p="";c==="descending"?p="-":c==="ascending"&&(p="+"),e.value.query.order=p+n,e.value.handleTableData()},handleInvertSelection:()=>{e.value.data.forEach(t=>{r.value.toggleRowSelection(t)})}}),f=h(null),l=h({visible:!1,title:"dialog",form:{},formRule:{email:[{required:!0,message:"邮箱",trigger:"blur"},{min:5,message:"用户名最少为5个字符",trigger:"blur"}]},formAction:"add",handleDialogAdd:()=>{l.value.title="创建数据",l.value.visible=!0,l.value.formAction="add",l.value.form={}},handleDialogEdit:t=>{l.value.title="编辑数据",l.value.visible=!0,l.value.formAction="edit",l.value.form=t},handleSubmitForm:()=>{f.value.validate(t=>{t?l.value.formAction==="add"?$(l.value.form).then(n=>{l.value.visible=!1,g.info(n),e.value.handleTableData()}):l.value.formAction==="edit"?F(l.value.form).then(n=>{l.value.visible=!1,g.info(n),e.value.handleTableData()}):g.error("提交错误"):g.error("请输入正确的数据！")})},handleDialogDelete:t=>{B.confirm(`请仔细确认是否删除数据[${t}]?`,"警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{L({id:t}).then(n=>{g.warning(n),e.value.handleTableData()})})}});return e.value.handleTableData(),(t,n)=>{const c=s("el-input"),p=s("el-form-item"),d=s("el-button"),S=s("el-form"),v=s("el-table-column"),x=s("el-table"),D=s("el-main"),w=s("el-dialog");return _(),E(A,null,[b("div",null,[a(S,{inline:!0},{default:o(()=>[a(p,{label:"名称"},{default:o(()=>[a(c,{modelValue:e.value.query.name,"onUpdate:modelValue":n[0]||(n[0]=i=>e.value.query.name=i),placeholder:"名称",clearable:""},null,8,["modelValue"])]),_:1}),a(p,null,{default:o(()=>[a(d,{type:"primary",icon:"search",onClick:e.value.handleTableData},{default:o(()=>[m(" 查询 ")]),_:1},8,["onClick"]),a(d,{type:"info",icon:"Refresh",onClick:e.value.handleQueryRefresh},{default:o(()=>[m(" 重置 ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),a(D,{class:"ea-table"},{default:o(()=>[a(d,{icon:e.value.selectStat?"SemiSelect":"Select",onClick:n[1]||(n[1]=i=>(e.value.selectStat=!e.value.selectStat)?"":r.value.clearSelection())},null,8,["icon"]),e.value.selectStat?(_(),y(d,{key:0,onClick:e.value.handleInvertSelection},{default:o(()=>[m(" 反选 ")]),_:1},8,["onClick"])):k("",!0),a(d,{type:"primary",icon:"Plus",onClick:l.value.handleDialogAdd},{default:o(()=>[m(" 新增 ")]),_:1},8,["onClick"]),a(x,{ref_key:"tableRef",ref:r,data:e.value.data,onSortChange:e.value.handleSortChange},{default:o(()=>[e.value.selectStat?(_(),y(v,{key:0,type:"selection",width:"50"})):k("",!0),a(v,{label:"ID",prop:"id",width:"80",sortable:"custom"}),a(v,{label:"名称",prop:"nickname",width:"160",align:"center"}),a(v,{label:"邮箱",width:"240"},{default:o(i=>[b("a",U,R(i.row.email),1)]),_:1}),a(v,{prop:"updatedAt",label:"最近更新",width:"200"}),a(v,{prop:"createdAt",label:"创建日期",width:"200"}),a(v,{fixed:"right",label:"操作",width:"105"},{default:o(i=>[a(d,{link:"",type:"primary",onClick:z=>l.value.handleDialogEdit(i.row)},{default:o(()=>[m(" 编辑 ")]),_:2},1032,["onClick"]),a(d,{link:"",type:"danger",onClick:z=>l.value.handleDialogDelete(i.row.id)},{default:o(()=>[m(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSortChange"]),I,a(M,{"page-size":e.value.query.limit,"onUpdate:pageSize":n[2]||(n[2]=i=>e.value.query.limit=i),total:e.value.total,onCurrentChange:e.value.handleChangePage,onSizeChange:e.value.handleChangeLimit},null,8,["page-size","total","onCurrentChange","onSizeChange"])]),_:1}),a(w,{modelValue:l.value.visible,"onUpdate:modelValue":n[5]||(n[5]=i=>l.value.visible=i),title:l.value.title,"close-on-click-modal":!1,"destroy-on-close":"","close-on-press-escape":"",center:""},{footer:o(()=>[b("span",P,[a(d,{onClick:n[4]||(n[4]=i=>l.value.visible=!1)},{default:o(()=>[m("取消")]),_:1}),a(d,{type:"primary",onClick:l.value.handleSubmitForm},{default:o(()=>[m("确定")]),_:1},8,["onClick"])])]),default:o(()=>[a(S,{ref_key:"dialogRef",ref:f,"label-position":"left",model:l.value.form,rules:l.value.formRule},{default:o(()=>[a(p,{label:"邮箱",prop:"email"},{default:o(()=>[a(c,{modelValue:l.value.form.email,"onUpdate:modelValue":n[3]||(n[3]=i=>l.value.form.email=i)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}};export{j as default};
