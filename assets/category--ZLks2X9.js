import{e as $,h as q,i as y,j as F}from"./archive-CX9pIz7a.js";import{r as _,f as s,o as M,c as N,g as t,w as o,j as i,t as S,a as k,F as j,x as V,E as d}from"./index-BCG0mEq2.js";import"./request-Tg78etE1.js";const z=k("br",null,null,-1),I={class:"dialog-footer"},J={__name:"category",setup(L){const c=_({query:{limit:9999,page:1,order:null,name:null},data:[]}),f=()=>{$(c.value.query).then(r=>{const l=[],u={};for(const n of r.data)n.parent<1?l.push(n):u[n.parent]?u[n.parent].push(n):u[n.parent]=[n];for(const n of l.keys()){const p=l[n].id;u[p]&&(l[n].children=u[p])}c.value.data=l})},b=_(null),e=_({visible:!1,title:"dialog",form:{},formRule:{name:[{required:!0,message:"名称",trigger:"blur"},{min:2,message:"用户名最少为2个字符",trigger:"blur"}]},formAction:"add"}),C=()=>{e.value.title="新增模板组",e.value.visible=!0,e.value.formAction="add",e.value.form={}},x=r=>{e.value.title="修改模板组",e.value.visible=!0,e.value.formAction="edit",e.value.form=r},h=r=>{const l=()=>{y({id:r.id,status:!r.status}).then(u=>{r.status=!r.status,d.info(u)})};r.status?V.confirm("请仔细确认是否下架 "+r.name+" ?","警告",{confirmButtonText:"下架",cancelButtonText:"取消",type:"warning"}).then(()=>{l()}):l()},w=()=>{b.value.validate(r=>{r?e.value.formAction==="add"?q(e.value.form).then(l=>{e.value.visible=!1,d.success(l),f()}):e.value.formAction==="edit"?(y(e.value.form).then(l=>{e.value.visible=!1,d.info(l),f()}),e.value.visible=!1):d.warning("提交错误"):d.error("请输入正确的数据！")})},A=r=>{V.confirm("请仔细确认是否删除 "+r.name+" ?","警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{F({id:r.id}).then(l=>{d.warning(l),f()})})};return f(),(r,l)=>{const u=s("el-button"),n=s("el-table-column"),p=s("el-link"),B=s("el-table"),D=s("el-main"),v=s("el-input"),m=s("el-form-item"),E=s("el-switch"),T=s("el-input-number"),U=s("el-form"),R=s("el-dialog");return M(),N(j,null,[t(D,{class:"ea-table"},{default:o(()=>[t(u,{type:"primary",icon:"Plus",onClick:C},{default:o(()=>[i(" 新增 ")]),_:1}),t(B,{data:c.value.data,"row-key":"id","default-expand-all":""},{default:o(()=>[t(n,{prop:"name",label:"名称"}),t(n,{prop:"status",label:"状态"},{default:o(a=>[t(p,{type:a.row.status>0?"success":"danger",onClick:g=>h(a.row)},{default:o(()=>[i(S(a.row.status>0?a.row.status>1?a.row.status:"开启":"关闭"),1)]),_:2},1032,["type","onClick"])]),_:1}),t(n,{prop:"order",label:"排序",sortable:""}),t(n,{prop:"updatedAt",label:"最近更新"}),t(n,{prop:"createdAt",label:"创建日期"}),t(n,{align:"center",label:"操作","min-width":"120"},{default:o(a=>[t(u,{link:"",type:"primary",onClick:g=>x(a.row)},{default:o(()=>[i(" 编辑 ")]),_:2},1032,["onClick"]),t(u,{link:"",type:"danger",onClick:g=>A(a.row)},{default:o(()=>[i(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),z]),_:1}),t(R,{modelValue:e.value.visible,"onUpdate:modelValue":l[6]||(l[6]=a=>e.value.visible=a),title:e.value.title,"close-on-click-modal":!1,"destroy-on-close":"","close-on-press-escape":"",center:""},{footer:o(()=>[k("span",I,[t(u,{onClick:l[5]||(l[5]=a=>e.value.visible=!1)},{default:o(()=>[i("取消")]),_:1}),t(u,{type:"primary",onClick:w},{default:o(()=>[i("确定")]),_:1})])]),default:o(()=>[t(U,{ref_key:"dialogRef",ref:b,"label-position":"left",model:e.value.form,rules:e.value.formRule},{default:o(()=>[t(m,{label:"名称",prop:"name"},{default:o(()=>[t(v,{modelValue:e.value.form.name,"onUpdate:modelValue":l[0]||(l[0]=a=>e.value.form.name=a)},null,8,["modelValue"])]),_:1}),t(m,{label:"状态"},{default:o(()=>[t(E,{modelValue:e.value.form.status,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.form.status=a),size:"large","active-text":"开启","inactive-text":"关闭","active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),t(m,{label:"父级",prop:"parent"},{default:o(()=>[t(T,{modelValue:e.value.form.parent,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.form.parent=a)},null,8,["modelValue"])]),_:1}),t(m,{label:"排序",prop:"order"},{default:o(()=>[t(v,{modelValue:e.value.form.order,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.form.order=a)},null,8,["modelValue"])]),_:1}),t(m,{label:"内容",prop:"content"},{default:o(()=>[t(v,{modelValue:e.value.form.content,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.form.content=a),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}};export{J as default};
