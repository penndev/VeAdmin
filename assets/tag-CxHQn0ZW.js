import{a as F,k as N,l as y,m as M}from"./archive-BipOGPVU.js";import{r as v,f as i,o as P,c as j,a as _,g as e,w as o,j as f,t as I,F as L,E as p,x as k}from"./index-3JgF3c3i.js";import"./request-KlnqnHWV.js";const Q=_("br",null,null,-1),G={class:"dialog-footer"},W={__name:"tag",setup(H){const u=v({total:0,query:{limit:20,page:1,order:null,name:null},data:[]}),V=a=>{u.value.query.name=null,u.value.query.order=null,r()},C=a=>{u.value.query.page=a,r()},w=a=>{u.value.query.limit=a,r()},x=({column:a,prop:t,order:d})=>{let s="";d==="descending"?s="-":d==="ascending"&&(s="+"),u.value.query.order=s+t,r()},r=()=>{F(u.value.query).then(a=>{u.value.data=a.data,u.value.total=a.total})},g=v(null),l=v({visible:!1,title:"dialog",form:{},formRule:{email:[{required:!0,message:"邮箱",trigger:"blur"},{min:5,message:"用户名最少为5个字符",trigger:"blur"}]},formAction:"add"}),q=()=>{l.value.title="创建数据",l.value.visible=!0,l.value.formAction="add",l.value.form={}},T=a=>{l.value.title="创建数据",l.value.visible=!0,l.value.formAction="edit",l.value.form=a},A=()=>{g.value.validate(a=>{a?l.value.formAction==="add"?N(l.value.form).then(t=>{l.value.visible=!1,p.info(t),r()}):l.value.formAction==="edit"?(y(l.value.form).then(t=>{l.value.visible=!1,p.info(t),r()}),l.value.visible=!1):p.info("提交错误"):p.error("请输入正确的数据！")})},B=a=>{const t=()=>{y({id:a.id,status:!a.status}).then(d=>{a.status=!a.status,p.info(d)})};a.status?k.confirm("请仔细确认是否下架 "+a.name+" ?","警告",{confirmButtonText:"下架",cancelButtonText:"取消",type:"warning"}).then(()=>{t()}):t()},D=a=>{k.confirm(`请仔细确认是否删除数据[${a}]?`,"警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{M({id:a}).then(t=>{p.warning(t),r()})})};return r(),(a,t)=>{const d=i("el-input"),s=i("el-form-item"),c=i("el-button"),b=i("el-form"),m=i("el-table-column"),S=i("el-link"),E=i("el-table"),R=i("el-pagination"),U=i("el-main"),z=i("el-switch"),$=i("el-dialog");return P(),j(L,null,[_("div",null,[e(b,{inline:!0},{default:o(()=>[e(s,{label:"名称"},{default:o(()=>[e(d,{modelValue:u.value.query.name,"onUpdate:modelValue":t[0]||(t[0]=n=>u.value.query.name=n),placeholder:"名称",clearable:""},null,8,["modelValue"])]),_:1}),e(s,null,{default:o(()=>[e(c,{type:"primary",icon:"search",onClick:r},{default:o(()=>[f(" 查询 ")]),_:1}),e(c,{type:"info",icon:"Refresh",onClick:V},{default:o(()=>[f(" 重置 ")]),_:1})]),_:1})]),_:1})]),e(U,{class:"ea-table"},{default:o(()=>[e(c,{type:"primary",icon:"Plus",onClick:q},{default:o(()=>[f(" 新增 ")]),_:1}),e(E,{data:u.value.data,style:{width:"100%"},onSortChange:x},{default:o(()=>[e(m,{prop:"id",label:"ID",width:"80",sortable:"custom"}),e(m,{prop:"name",label:"名称",width:"160"}),e(m,{prop:"status",label:"状态",width:"160"},{default:o(n=>[e(S,{type:n.row.status>0?"success":"danger",onClick:h=>B(n.row)},{default:o(()=>[f(I(n.row.status>0?n.row.status>1?n.row.status:"开启":"关闭"),1)]),_:2},1032,["type","onClick"])]),_:1}),e(m,{prop:"hits",label:"热度",width:"160"}),e(m,{prop:"content",label:"描述",width:"160"}),e(m,{prop:"updatedAt",label:"最近更新",width:"200"}),e(m,{prop:"createdAt",label:"创建日期",width:"200"}),e(m,{fixed:"right",label:"操作",width:"105"},{default:o(n=>[e(c,{link:"",type:"primary",onClick:h=>T(n.row)},{default:o(()=>[f(" 编辑 ")]),_:2},1032,["onClick"]),e(c,{link:"",type:"danger",onClick:h=>D(n.row.id)},{default:o(()=>[f(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Q,e(R,{background:"",layout:"total, sizes, prev, pager, next",total:u.value.total,"page-size":u.value.query.limit,onCurrentChange:C,onSizeChange:w},null,8,["total","page-size"])]),_:1}),e($,{modelValue:l.value.visible,"onUpdate:modelValue":t[6]||(t[6]=n=>l.value.visible=n),title:l.value.title,"close-on-click-modal":!1,"destroy-on-close":"","close-on-press-escape":"",center:""},{footer:o(()=>[_("span",G,[e(c,{onClick:t[5]||(t[5]=n=>l.value.visible=!1)},{default:o(()=>[f("取消")]),_:1}),e(c,{type:"primary",onClick:A},{default:o(()=>[f("确定")]),_:1})])]),default:o(()=>[e(b,{ref_key:"dialogRef",ref:g,"label-position":"left",model:l.value.form,rules:l.value.formRule},{default:o(()=>[e(s,{label:"名称",prop:"name"},{default:o(()=>[e(d,{modelValue:l.value.form.name,"onUpdate:modelValue":t[1]||(t[1]=n=>l.value.form.name=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"状态"},{default:o(()=>[e(z,{modelValue:l.value.form.status,"onUpdate:modelValue":t[2]||(t[2]=n=>l.value.form.status=n),size:"large","active-text":"开启","inactive-text":"关闭","active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),e(s,{label:"热度",prop:"hits"},{default:o(()=>[e(d,{modelValue:l.value.form.hits,"onUpdate:modelValue":t[3]||(t[3]=n=>l.value.form.hits=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"描述",prop:"content"},{default:o(()=>[e(d,{modelValue:l.value.form.content,"onUpdate:modelValue":t[4]||(t[4]=n=>l.value.form.content=n),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}};export{W as default};
