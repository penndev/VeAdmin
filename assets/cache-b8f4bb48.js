import{f as A,h as b}from"./wafcdn-1bd7aa87.js";import{r as C,f as c,o as m,c as H,a as q,g as e,w as t,j as u,h as g,s as h,t as v,n as y,F as I,x as k,E as w,q as P,K as x}from"./index-32dea956.js";import"./request-b9a42b87.js";const Y=q("br",null,null,-1),G={__name:"cache",setup(j){const f=C(),z=()=>{l.value.data.forEach(a=>{f.value.toggleRowSelection(a)})},l=C({selectStat:!1,total:0,query:{limit:20,page:1,order:null,path:null},data:[]}),B=a=>{l.value.query.name=null,l.value.query.order=null,i()},F=a=>{l.value.query.page=a,i()},E=a=>{l.value.query.limit=a,i()},V=({column:a,prop:o,order:r})=>{let _="";r==="descending"?_="-":r==="ascending"&&(_="+"),l.value.query.order=_+o,i()},i=()=>{A(l.value.query).then(a=>{l.value.data=a.data,l.value.total=a.total})},D=a=>{k.confirm(`请仔细确认是否删除数据[${a.File}]?`,"警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{b({file:a.File}).then(o=>{w.warning(o),i()})})},R=()=>{const a=f.value.getSelectionRows();let o="";a.forEach(r=>{o!==""&&(o+=","),o+=r.File}),k.confirm(`请仔细确认是否删除 ${a.length} 条数据?`,"警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{b({file:o}).then(r=>{w.warning(r),i()})})};return i(),(a,o)=>{const r=c("el-input"),_=c("el-form-item"),s=c("el-button"),T=c("el-form"),d=c("el-table-column"),p=c("el-link"),S=c("el-tooltip"),N=c("el-table"),$=c("el-pagination"),M=c("el-main");return m(),H(I,null,[q("div",null,[e(T,{inline:!0},{default:t(()=>[e(_,{label:"路径"},{default:t(()=>[e(r,{modelValue:l.value.query.path,"onUpdate:modelValue":o[0]||(o[0]=n=>l.value.query.path=n),placeholder:"/url",clearable:""},null,8,["modelValue"])]),_:1}),e(_,null,{default:t(()=>[e(s,{type:"primary",icon:"search",onClick:i},{default:t(()=>[u(" 查询 ")]),_:1}),e(s,{type:"info",icon:"Refresh",onClick:B},{default:t(()=>[u(" 重置 ")]),_:1})]),_:1})]),_:1})]),e(M,{class:"ea-table"},{default:t(()=>[e(s,{type:"primary",size:"small",icon:l.value.selectStat?"SemiSelect":"Select",onClick:o[1]||(o[1]=n=>l.value.selectStat=!l.value.selectStat)},null,8,["icon"]),l.value.selectStat?(m(),g(s,{key:0,size:"small",onClick:z},{default:t(()=>[u(" 反选 ")]),_:1})):h("",!0),l.value.selectStat?(m(),g(s,{key:1,size:"small",onClick:f.value.clearSelection},{default:t(()=>[u(" 清空 ")]),_:1},8,["onClick"])):h("",!0),l.value.selectStat?(m(),g(s,{key:2,size:"small",type:"danger",onClick:R},{default:t(()=>[u(" 删除选中 ")]),_:1})):h("",!0),e(N,{ref_key:"tableRef",ref:f,data:l.value.data,onSortChange:V},{default:t(()=>[l.value.selectStat?(m(),g(d,{key:0,type:"selection",width:"50"})):h("",!0),e(d,{label:"站点",prop:"SiteID"}),e(d,{label:"路径",align:"center"},{default:t(n=>[e(S,{content:n.row.File,placement:"top"},{default:t(()=>[e(p,null,{default:t(()=>[u(v(n.row.Path),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),e(d,{label:"文件大小",align:"center"},{default:t(n=>[e(p,null,{default:t(()=>[u(v(y(P)(n.row.Size)),1)]),_:2},1024)]),_:1}),e(d,{label:"访问日期",align:"center"},{default:t(n=>[e(p,null,{default:t(()=>[u(v(y(x)("Y-m-d H:i:s",n.row.Accessed)),1)]),_:2},1024)]),_:1}),e(d,{label:"过期时间",align:"center"},{default:t(n=>[e(S,{content:"创建："+n.row.CreatedAt,placement:"top"},{default:t(()=>[e(p,null,{default:t(()=>[u(v(y(x)("Y-m-d H:i:s",n.row.Expired)),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),e(d,{fixed:"right",label:"操作",width:"65"},{default:t(n=>[e(s,{link:"",type:"danger",onClick:K=>D(n.row)},{default:t(()=>[u(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Y,e($,{background:"",layout:"total, sizes, prev, pager, next",total:l.value.total,"page-size":l.value.query.limit,onCurrentChange:F,onSizeChange:E},null,8,["total","page-size"])]),_:1})],64)}}};export{G as default};
