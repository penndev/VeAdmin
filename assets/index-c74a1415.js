import{s as h}from"./request-94f3b1c6.js";import{r as p,f as r,o as _,c as q,a as g,g as a,w as n,F as E,j as d,h as k,q as S,t as A,E as f,s as R}from"./index-99403b70.js";const B=m=>h({url:"/example/admin",method:"get",params:m}),$=m=>h({url:"/example/admin",method:"post",data:m}),z=m=>h({url:"/example/admin",method:"put",data:m}),F=m=>h({url:"/example/admin",method:"delete",params:m}),N={target:"_blank"},I=g("br",null,null,-1),P={class:"dialog-footer"},M={__name:"index",setup(m){const b=p(),e=p({total:0,query:{limit:20,page:1,order:null,name:null},data:[],handleTableData:()=>{B(e.value.query).then(o=>{e.value.data=o.data,e.value.total=o.total})},handleQueryRefresh:o=>{e.value.query.name=null,e.value.query.order=null,e.value.handleTableData()},handleChangePage:o=>{e.value.query.page=o,e.value.handleTableData()},handleChangeLimit:o=>{e.value.query.limit=o,e.value.handleTableData()},handleSortChange:({column:o,prop:t,order:v})=>{let s="";v==="descending"?s="-":v==="ascending"&&(s="+"),e.value.query.order=s+t,e.value.handleTableData()},handleInvertSelection:()=>{e.value.data.forEach(o=>{b.value.toggleRowSelection(o)})}}),C=p(null),l=p({visible:!1,title:"dialog",form:{},formRule:{email:[{required:!0,message:"邮箱",trigger:"blur"},{min:5,message:"用户名最少为5个字符",trigger:"blur"}]},formAction:"add",handleDialogAdd:()=>{l.value.title="创建数据",l.value.visible=!0,l.value.formAction="add",l.value.form={}},handleDialogEdit:o=>{l.value.title="编辑数据",l.value.visible=!0,l.value.formAction="edit",l.value.form=o},handleSubmitForm:()=>{C.value.validate(o=>{o?l.value.formAction==="add"?$(l.value.form).then(t=>{l.value.visible=!1,f.info(t),e.value.handleTableData()}):l.value.formAction==="edit"?z(l.value.form).then(t=>{l.value.visible=!1,f.info(t),e.value.handleTableData()}):f.error("提交错误"):f.error("请输入正确的数据！")})},handleDialogDelete:o=>{R.confirm(`请仔细确认是否删除数据[${o}]?`,"警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{F({id:o}).then(t=>{f.warning(t),e.value.handleTableData()})})}});return e.value.handleTableData(),(o,t)=>{const v=r("el-input"),s=r("el-form-item"),i=r("el-button"),y=r("el-form"),c=r("el-table-column"),D=r("el-table"),x=r("el-pagination"),w=r("el-main"),T=r("el-dialog");return _(),q(E,null,[g("div",null,[a(y,{inline:!0},{default:n(()=>[a(s,{label:"名称"},{default:n(()=>[a(v,{modelValue:e.value.query.name,"onUpdate:modelValue":t[0]||(t[0]=u=>e.value.query.name=u),placeholder:"名称",clearable:""},null,8,["modelValue"])]),_:1}),a(s,null,{default:n(()=>[a(i,{type:"primary",icon:"search",onClick:e.value.handleTableData},{default:n(()=>[d(" 查询 ")]),_:1},8,["onClick"]),a(i,{type:"info",icon:"Refresh",onClick:e.value.handleQueryRefresh},{default:n(()=>[d(" 重置 ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),a(w,{style:{"background-color":"#fff"}},{default:n(()=>[a(i,{type:"primary",icon:e.value.selectStat?"SemiSelect":"Select",onClick:t[1]||(t[1]=u=>e.value.selectStat=!e.value.selectStat)},null,8,["icon"]),e.value.selectStat?(_(),k(i,{key:0,onClick:e.value.handleInvertSelection},{default:n(()=>[d(" 反选 ")]),_:1},8,["onClick"])):S("",!0),e.value.selectStat?(_(),k(i,{key:1,onClick:t[2]||(t[2]=u=>b.value.clearSelection())},{default:n(()=>[d(" 清空 ")]),_:1})):S("",!0),a(i,{type:"primary",icon:"Plus",onClick:l.value.handleDialogAdd},{default:n(()=>[d(" 新增 ")]),_:1},8,["onClick"]),a(D,{data:e.value.data,onSortChange:e.value.handleSortChange},{default:n(()=>[a(c,{label:"ID",prop:"id",width:"80",sortable:"custom"}),a(c,{label:"名称",prop:"nickname",width:"160",align:"center"}),a(c,{label:"邮箱",width:"240"},{default:n(u=>[g("a",N,A(u.row.email),1)]),_:1}),a(c,{prop:"updatedAt",label:"最近更新",width:"200"}),a(c,{prop:"createdAt",label:"创建日期",width:"200"}),a(c,{fixed:"right",label:"操作",width:"105"},{default:n(u=>[a(i,{link:"",type:"primary",onClick:V=>l.value.handleDialogEdit(u.row)},{default:n(()=>[d(" 编辑 ")]),_:2},1032,["onClick"]),a(i,{link:"",type:"danger",onClick:V=>l.value.handleDialogDelete(u.row.id)},{default:n(()=>[d(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSortChange"]),I,a(x,{background:"",layout:"total, sizes, prev, pager, next",total:e.value.total,"page-size":e.value.query.limit,onCurrentChange:e.value.handleChangePage,onSizeChange:e.value.handleChangeLimit},null,8,["total","page-size","onCurrentChange","onSizeChange"])]),_:1}),a(T,{modelValue:l.value.visible,"onUpdate:modelValue":t[5]||(t[5]=u=>l.value.visible=u),title:l.value.title,"close-on-click-modal":!1,"destroy-on-close":"","close-on-press-escape":"",center:""},{footer:n(()=>[g("span",P,[a(i,{onClick:t[4]||(t[4]=u=>l.value.visible=!1)},{default:n(()=>[d("取消")]),_:1}),a(i,{type:"primary",onClick:l.value.handleSubmitForm},{default:n(()=>[d("确定")]),_:1},8,["onClick"])])]),default:n(()=>[a(y,{ref_key:"dialogRef",ref:C,"label-position":"left",model:l.value.form,rules:l.value.formRule},{default:n(()=>[a(s,{label:"邮箱",prop:"email"},{default:n(()=>[a(v,{modelValue:l.value.form.email,"onUpdate:modelValue":t[3]||(t[3]=u=>l.value.form.email=u)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}};export{M as default};
