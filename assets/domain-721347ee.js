import{b as O,c as T}from"./wafcdn-130ee3ac.js";import{r as h,f as n,o as i,c as _,g as e,w as a,j as p,t as $,a as D,F as b,x as g,E as y,v as j,h as w}from"./index-a024b2b5.js";import"./request-01f1eb3e.js";const z=D("br",null,null,-1),G={key:1},H={key:1},I={class:"dialog-footer"},Y={__name:"domain",setup(K){const v=h({data:[]}),B=()=>{O().then(m=>{v.value.data=m})},U=h(null),l=h({visible:!1,title:"dialog",form:{},formTmp:{},formRule:{},formAction:"add"}),A=()=>{l.value.title="绑定新域名",l.value.visible=!0,l.value.formAction="add",l.value.form={},l.value.formTmp={domain:"",port:0,ssl:{port:0,crt:"",key:""},backend:{url:"",host:"",req_header:[],resp_header:[]},cache:{dir:"",rule:[]}}},S=m=>{l.value.title="修改 "+m.domain+" 的配置",l.value.visible=!0,l.value.formAction="edit",l.value.form=m,l.value.formTmp=JSON.parse(JSON.stringify(m)),l.value.formTmp.ssl.crt=atob(m.ssl.crt),l.value.formTmp.ssl.key=atob(m.ssl.key)},E=()=>{U.value.validate(m=>{if(m)if(l.value.formAction==="add")v.value.data.push(l.value.formTmp),T(v.value.data).then(t=>{l.value.visible=!1,y.info("新增完成")});else if(l.value.formAction==="edit"){l.value.formTmp.ssl.crt=btoa(l.value.formTmp.ssl.crt),l.value.formTmp.ssl.key=btoa(l.value.formTmp.ssl.key);for(const t in l.value.formTmp)l.value.form[t]=l.value.formTmp[t];T(v.value.data).then(t=>{l.value.visible=!1,y.info("修改完成")})}else y.error("提交错误");else y.error("请输入正确的数据！")})},N=m=>{j.confirm(`请仔细确认是否删除数据[${m}]?`,"警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{v.value.data.splice(m,1),T(v.value.data).then(t=>{l.value.visible=!1,y.info("删除完成")})})};return B(),(m,t)=>{const c=n("el-button"),V=n("el-table-column"),x=n("el-text"),C=n("el-link"),P=n("el-table"),R=n("el-main"),d=n("el-input"),s=n("el-form-item"),q=n("el-input-number"),k=n("el-tab-pane"),u=n("el-col"),F=n("el-row"),M=n("el-tabs"),J=n("el-form"),L=n("el-dialog");return i(),_(b,null,[e(R,{class:"ea-table"},{default:a(()=>[e(c,{type:"primary",icon:"Plus",onClick:A},{default:a(()=>[p(" 新增 ")]),_:1}),e(P,{data:v.value.data},{default:a(()=>[e(V,{label:"域名",prop:"domain",align:"center"}),e(V,{label:"端口(http)",prop:"port",align:"center"}),e(V,{label:"端口(https)",prop:"ssl.port",align:"center"}),e(V,{label:"源站",align:"center"},{default:a(o=>[e(x,{type:"info"},{default:a(()=>[p(" 回源地址: ")]),_:1}),p(),e(C,{type:"primary"},{default:a(()=>[p($(o.row.backend.url),1)]),_:2},1024),p(),z,e(x,{type:"info"},{default:a(()=>[p(" 回源域名: ")]),_:1}),p(),e(C,{type:"warning"},{default:a(()=>[p($(o.row.backend.host),1)]),_:2},1024)]),_:1}),e(V,{label:"缓存目录",prop:"cache.dir",align:"center"}),e(V,{fixed:"right",label:"操作",width:"105"},{default:a(o=>[e(c,{link:"",type:"primary",onClick:f=>S(o.row)},{default:a(()=>[p(" 编辑 ")]),_:2},1032,["onClick"]),e(c,{link:"",type:"danger",onClick:f=>N(o.$index)},{default:a(()=>[p(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),e(L,{modelValue:l.value.visible,"onUpdate:modelValue":t[12]||(t[12]=o=>l.value.visible=o),title:l.value.title,"close-on-click-modal":!1,"destroy-on-close":"","close-on-press-escape":"",center:""},{footer:a(()=>[D("span",I,[e(c,{onClick:t[11]||(t[11]=o=>l.value.visible=!1)},{default:a(()=>[p("取消")]),_:1}),e(c,{type:"primary",onClick:E},{default:a(()=>[p("确定")]),_:1})])]),default:a(()=>[e(J,{ref_key:"dialogRef",ref:U,"label-position":"left",model:l.value.formTmp,rules:l.value.formRule},{default:a(()=>[e(M,{type:"border-card"},{default:a(()=>[e(k,{label:"域名设置"},{default:a(()=>[e(s,{label:"域名",prop:"domain"},{default:a(()=>[e(d,{modelValue:l.value.formTmp.domain,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.formTmp.domain=o)},null,8,["modelValue"])]),_:1}),e(s,{label:"端口",prop:"port"},{default:a(()=>[e(q,{modelValue:l.value.formTmp.port,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.formTmp.port=o)},null,8,["modelValue"])]),_:1})]),_:1}),e(k,{label:"回源管理"},{default:a(()=>[e(s,{label:"回源路径",prop:"backend.url"},{default:a(()=>[e(d,{modelValue:l.value.formTmp.backend.url,"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.formTmp.backend.url=o)},null,8,["modelValue"])]),_:1}),e(s,{label:"回源域名",prop:"backend.host"},{default:a(()=>[e(d,{modelValue:l.value.formTmp.backend.host,"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.formTmp.backend.host=o)},null,8,["modelValue"])]),_:1}),e(s,{label:"回源请求头"},{default:a(()=>[(i(!0),_(b,null,g(l.value.formTmp.backend.req_header,(o,f)=>(i(),_(b,{key:f},[e(u,{span:11},{default:a(()=>[e(d,{modelValue:o.name,"onUpdate:modelValue":r=>o.name=r,placeholder:"名"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:2,style:{"text-align":"center"}},{default:a(()=>[f==0?(i(),w(c,{key:0,type:"primary",icon:"Plus",circle:"",onClick:t[4]||(t[4]=r=>l.value.formTmp.backend.req_header.push({name:"",value:""}))})):(i(),_("span",G,"-"))]),_:2},1024),e(u,{span:11},{default:a(()=>[e(d,{modelValue:o.value,"onUpdate:modelValue":r=>o.value=r,placeholder:"值"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:24,style:{height:"5px"}})],64))),128))]),_:1}),e(s,{label:"回源返回头"},{default:a(()=>[(i(!0),_(b,null,g(l.value.formTmp.backend.resp_header,(o,f)=>(i(),_(b,{key:f},[e(u,{span:11},{default:a(()=>[e(d,{modelValue:o.name,"onUpdate:modelValue":r=>o.name=r,placeholder:"名"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:2,style:{"text-align":"center"}},{default:a(()=>[f==0?(i(),w(c,{key:0,type:"primary",icon:"Plus",circle:"",onClick:t[5]||(t[5]=r=>l.value.formTmp.backend.resp_header.push({name:"",value:""}))})):(i(),_("span",H,"-"))]),_:2},1024),e(u,{span:11},{default:a(()=>[e(d,{modelValue:o.value,"onUpdate:modelValue":r=>o.value=r,placeholder:"值"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:24,style:{height:"5px"}})],64))),128))]),_:1})]),_:1}),e(k,{label:"SSL"},{default:a(()=>[e(s,{label:"回源路径",prop:"ssl.port"},{default:a(()=>[e(d,{modelValue:l.value.formTmp.ssl.port,"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.formTmp.ssl.port=o)},null,8,["modelValue"])]),_:1}),e(F,null,{default:a(()=>[e(u,{span:11},{default:a(()=>[e(s,{label:"证书",prop:"ssl.crt"},{default:a(()=>[e(d,{modelValue:l.value.formTmp.ssl.crt,"onUpdate:modelValue":t[7]||(t[7]=o=>l.value.formTmp.ssl.crt=o),rows:"15",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:11},{default:a(()=>[e(s,{label:"密钥",prop:"ssl.key"},{default:a(()=>[e(d,{modelValue:l.value.formTmp.ssl.key,"onUpdate:modelValue":t[8]||(t[8]=o=>l.value.formTmp.ssl.key=o),rows:"15",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{label:"缓存配置"},{default:a(()=>[e(s,{label:"缓存路径",prop:"cache.dir"},{default:a(()=>[e(d,{modelValue:l.value.formTmp.cache.dir,"onUpdate:modelValue":t[9]||(t[9]=o=>l.value.formTmp.cache.dir=o)},null,8,["modelValue"])]),_:1}),e(s,{label:"缓存规则"},{default:a(()=>[(i(!0),_(b,null,g(l.value.formTmp.cache.rule,(o,f)=>(i(),_(b,{key:f},[e(u,{span:11},{default:a(()=>[e(d,{modelValue:o.path,"onUpdate:modelValue":r=>o.path=r,placeholder:"名"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:2,style:{"text-align":"center"}},{default:a(()=>[e(c,{icon:"Minus",circle:"",onClick:r=>l.value.formTmp.cache.rule.splice(f,1)},null,8,["onClick"])]),_:2},1024),e(u,{span:11},{default:a(()=>[e(d,{modelValue:o.time,"onUpdate:modelValue":r=>o.time=r,placeholder:"值(分钟)"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:24,style:{height:"5px"}})],64))),128)),e(c,{type:"primary",icon:"Plus",circle:"",onClick:t[10]||(t[10]=o=>l.value.formTmp.cache.rule.push({path:"/example",time:1440}))})]),_:1})]),_:1}),e(k,{label:"安全配置"},{default:a(()=>[p(" 暂未开启 ")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}};export{Y as default};
